steps:
  - script: 'git clone --single-branch --progress -b $(helperBranch) %EXTREPO_URL% %EXTREPO_DIR% 2>&1'
    displayName: 'Fetch external repo'
    env:
      EXTREPO_URL: $(extRepo.url)
      EXTREPO_DIR: $(extRepo.dir)
    timeoutInMinutes: 0

  - task: PowerShell@2
    displayName: 'Run regression script'
    inputs:
      targetType: filePath
      filePath: $(Build.Repository.LocalPath)\_Helper\TestInstallPrerequisites\Setup-InstallEnvironment.ps1
      arguments: '-Workspace "$(Pipeline.Workspace)" -SourcePath "$(Build.Repository.LocalPath)" -HelperBranch "$(helperBranch)" -TestSuiteBranch "$(Build.SourceBranch)" -BuildUser "$(Build.QueuedBy)" -ReleaseMSIPath "$(ReleaseMSIPath)" -ReleaseMSIUserName "$(ReleaseMSIUserName)" -ReleaseMSIPassword "$(ReleaseMSIPassword)" -SenderUsername "$(smtp.senderUsername)" -SenderPassword "$(smtp.senderPassword)"'
      timeoutInMinutes: 0